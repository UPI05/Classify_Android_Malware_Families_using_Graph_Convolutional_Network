import json

# Path to your JSON file
file_path = 'proposed.json'  # Update this to the actual path of your JSON file

# Function to load JSON data from a file
def load_data(filepath):
    with open(filepath, 'r') as file:
        return json.load(file)

# Function to count malware types in the data
def count_malware_types(data):
    counts = {}
    for sha256, malware_type in data.items():
        if malware_type in counts:
            counts[malware_type] += 1
        else:
            counts[malware_type] = 1
    return counts

# Load the data
malware_data = load_data(file_path)

# Count the malware types
malware_counts = count_malware_types(malware_data)

# Sort the counts in descending order by the number of files
sorted_malware_counts = sorted(malware_counts.items(), key=lambda x: x[1], reverse=True)

# Print the results
#for malware_type, count in sorted_malware_counts:
#    print(f"{malware_type}: {count} files")


# Function to collect SHA256 hashes for specific malware types with a limit
def collect_sha256_by_type(data, malware_types, limit=500):
    sha256_lists = {malware_type: [] for malware_type in malware_types}
    for sha256, malware_type in data.items():
        if malware_type in sha256_lists and len(sha256_lists[malware_type]) < limit:
            sha256_lists[malware_type].append(sha256)
    return sha256_lists

# Function to save data to a JSON file
def save_data_to_json(data, filepath):
    with open(filepath, 'w') as file:
        json.dump(data, file, indent=4)

# Specify the malware types of interest
types_of_interest = ['adware', 'trojan', 'exploit', 'downloader', 'smssend', 'monitor', 'backdoor', 'worm']

# Collect SHA256 hashes for types_of_interest with a limit of 500 each
sha256_lists = collect_sha256_by_type(malware_data, types_of_interest)

# Save the collected data to a JSON file
output_filepath = 'filtered_sha256.json'  # Update this to the desired output file path
save_data_to_json(sha256_lists, output_filepath)